const fs = require("fs-extra");
const axios = require("axios");
const path = require("path");

module.exports.config = {
  name: "salam",
  version: "5.2",
  hasPermssion: 0,
  credits: "MR JUWEL",
  description: "Auto reply to salam with Islamic message + user name + profile pic",
  commandCategory: "noprefix",
  usages: "assalamu alaikum",
  cooldowns: 5,
};

module.exports.handleEvent = async function ({ api, event, Users }) {
  const { threadID, messageID, senderID, body } = event;
  if (!body) return;

  const salamWords = [
    "assalamu alaikum",
    "assalamualaikum",
    "à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®",
    "Assalamu alaikum",
    "à¦†à§à¦à¦¸à§à¦à¦¸à¦¾à§à¦à¦²à¦¾à§à¦à¦®à§à§à¦ à¦†à§à¦à¦²à¦¾à§à¦à¦‡à§à¦à¦•à§à§à¦à¦®à§à¦"
  ];

  const message = body.toLowerCase();
  if (!salamWords.some((word) => message.includes(word))) return;

  try {

    const name = await Users.getNameUser(senderID);

    // Profile Picture
    const profilePicUrl = `https://graph.facebook.com/${senderID}/picture?height=720&width=720&access_token=6628568379%7Cc1e620fa708a1d5696fb991c1bde5662`;

    const cacheDir = path.join(__dirname, "cache");
    if (!fs.existsSync(cacheDir)) fs.mkdirSync(cacheDir);

    const imgPath = path.join(cacheDir, `${senderID}.jpg`);
    const picBuffer = (await axios.get(profilePicUrl, { responseType: "arraybuffer" })).data;
    fs.writeFileSync(imgPath, picBuffer);

    // Islamic Lines
    const islamicLines = [
      "ðŸ–¤ à¦¹à¦¾à¦œà¦¾à¦°-à¦Ÿà¦¾ à¦§à¦°à§à¦®à§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦†à¦®à¦°à¦¾ à¦®à§à¦¸à¦²à¦¿à¦®..!ðŸ¥° à¦†à¦²à¦¹à¦¾à¦®à¦¦à§à¦²à¦¿à¦²à§à¦²à¦¾à¦¹ ðŸ¤²",
      "à¦®à§ƒà¦¤à§à¦¯à§ à¦¯à§‡à¦¨à§‹ à¦‡à¦®à¦¾à¦¨à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¹à§Ÿ ðŸ¤²",
      "à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦ªà¦¥à§‡ à¦¹à¦¾à¦à¦Ÿà¦²à§‡ à¦®à¦¨ à¦¶à¦¾à¦¨à§à¦¤à¦¿ à¦ªà¦¾à§Ÿ ðŸŒ¸",
      "Nothing is possible without Allah âœ¨",
      "à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦“à¦ªà¦° à¦­à¦°à¦¸à¦¾ à¦•à¦°à§‹, à¦¤à¦¿à¦¨à¦¿ à¦•à¦–à¦¨à§‹ à¦¨à¦¿à¦°à¦¾à¦¶ à¦•à¦°à§‡à¦¨ à¦¨à¦¾ ðŸŒº",
      "à¦²à¦¾ à¦‡à¦²à¦¾à¦¹à¦¾ à¦‡à¦²à§à¦²à¦¾à¦²à§à¦²à¦¾à¦¹à§ à¦®à§à¦¹à¦¾à¦®à§à¦®à¦¾à¦¦à§à¦° à¦°à¦¾à¦¸à§à¦²à§à¦²à§à¦²à¦¾à¦¹ ðŸŒ¸",
      "à¦¦à§à¦¨à¦¿à¦¯à¦¼à¦¾à¦° à¦¸à§Œà¦¨à§à¦¦à¦°à§à¦¯à§‡à¦° à¦šà§‡à¦¯à¦¼à§‡ à¦†à¦–à¦¿à¦°à¦¾à¦¤à§‡à¦° à¦¸à§Œà¦¨à§à¦¦à¦°à§à¦¯ à¦¬à§‡à¦¶à¦¿ à¦¸à§à¦¥à¦¾à¦¯à¦¼à§€ ðŸ’–",
      "Always make dua ðŸ¤² à¦†à¦²à§à¦²à¦¾à¦¹ à¦¸à¦¬à¦•à¦¿à¦›à§ à¦¬à¦¦à¦²à§‡ à¦¦à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨!","â†â€¢â†’â€¢(Best Line)â€¢â†â€¢â†’â€¢\nðŸ–¤ à¦¹à¦¾à¦œà¦¾à¦°-à¦Ÿà¦¾ à¦§à¦°à§à¦®à§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦†à¦®à¦°à¦¾ à¦®à§à¦¸à¦²à¦¿à¦®..!ðŸ¥°\nà¦¹à§à¦¯à¦¾à¦ à¦à¦Ÿà¦¾à¦‡ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à§Œà¦­à¦¾à¦—à§à¦¯â€¦!ðŸ¥€\nðŸ¤ Alhamdulillahâ€¦ðŸ¥€ðŸ¤²",
      "â”€â”€à¼Šâœ¾ðˆ ð–ð¢ð¬ð¡à¼Šâœ¾â”€â”€\nà¦®à§ƒà¦¤à§à¦¯à§à¦Ÿà¦¾ à¦¯à§‡à¦¨à§‹ à¦‡à¦®à¦¾à¦¨à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¹à¦¯à¦¼..!ðŸ–¤\nâ”€à¼Šâœ¾ð€ð¦ð¢ð§à¼Šâœ¾â”€â˜ºï¸ðŸ¤²",
      "à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦ªà¦¥à§‡ à¦¹à¦¾à¦à¦Ÿà¦¤à§‡ à¦•à¦·à§à¦Ÿ à¦¹à¦¬à§‡, à¦à¦•à¦¾ à¦²à¦¾à¦—à¦¬à§‡, à¦•à¦¿à¦¨à§à¦¤à§ à¦œà¦¾à¦¨à§à¦¨à¦¾à¦¤ à¦¤à¦¾à¦° à¦šà§‡à§Ÿà§‡à¦“ à¦¬à§‡à¦¶à¦¿ à¦¶à¦¾à¦¨à§à¦¤à¦¿à¦° à¦œà¦¾à§Ÿà¦—à¦¾à¥¤ ðŸŒ¸",
      "ðð¨ð­ð¡ð¢ð§ð  ð¢ð¬ ð©ð¨ð¬ð¬ð¢ð›ð¥ðž ð°ð¢ð­ð¡ð¨ð®ð­ ð€ð¥ð¥ðšð¡.âœ¨ðŸ–¤",
      "à¦†à¦²à§à¦²à¦¾à¦¹â€™à¦° à¦ªà§à¦°à¦¤à¦¿ à¦†à¦¸à§à¦¥à¦¾ à¦†à¦° à¦¬à¦¿à¦¶à§à¦¬à¦¾à¦¸ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦¸à¦¾à¦«à¦²à§à¦¯à§‡à¦° à¦ªà¦¥ à¦¦à§‡à¦–à¦¾à¦¬à§‡, à¦‡à¦¨à¦¶à¦¾à¦†à¦²à§à¦²à¦¾à¦¹â€!!ðŸŒº",
      "Â°-ð°ð¡ðšð­â€™ð¬ ð˜ð¨ð®ð« ð‘ðžðšð¥ ð€ððð«ðžð¬ð¬\n-à¦¸à¦¾à¦¡à¦¼à§‡ à¦¤à¦¿à¦¨ à¦¹à¦¾à¦¤ à¦®à¦¾à¦Ÿà¦¿à¦° à¦¨à¦¿à¦šà§‡ ðŸ’Ÿ\nØ¥ÙÙ†ÙŽÙ‘Ø§ Ù„ÙÙ„Ù‘Ù‡Ù ÙˆÙŽØ¥ÙÙ†ÙŽÙ‘Ù€Ø§ Ø¥ÙÙ„ÙŽÙŠÙ’Ù‡Ù Ø±ÙŽØ§Ø¬ÙØ¹ÙÙˆÙ†ÙŽ\nà¦à¦–à¦¾à¦¨à§‡à¦‡ à¦†à¦®à¦¾à¦° à¦—à¦²à§à¦ª à¦¶à§‡à¦·!ðŸðŸ˜”",
      "ðŸŒ¸âœ¿ à¦¨à¦¿à¦¯à¦¼à¦¤ â› à¦¯à¦¦à¦¿ à¦¨à§‡à¦• à¦†à¦° à¦²à¦•à§à¦·à§à¦¯ à¦¯à¦¦à¦¿ à¦¸à¦ à¦¿à¦• à¦¹à¦¯à¦¼ à¦¸à¦¾à¦«à¦²à§à¦¯ à¦†à¦¸à¦¬à§‡à¦‡ ðŸ–¤ðŸ¦‹à¥¤à¥¤\nâŒ“â¥ï¸Žðˆð§ ð¬ð¡ðš ð€ð¥ð¥ðšð¡â¥ï¸ŽâŒ“ ðŸŒ¸",
      "ðŸ•Œ à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦¸à§à¦®à¦°à¦£à§‡à¦‡ à¦œà§€à¦¬à¦¨à§‡à¦° à¦ªà§à¦°à¦•à§ƒà¦¤ à¦¶à¦¾à¦¨à§à¦¤à¦¿ à¦²à§à¦•à¦¿à§Ÿà§‡ à¦†à¦›à§‡à¥¤ à¦ªà§à¦°à¦¤à¦¿à¦¦à¦¿à¦¨ à¦¨à¦¾à¦®à¦¾à¦œ à¦ªà§œà§‹, à¦®à¦¨ à¦ªà¦¾à¦¬à§‡ à¦ªà§à¦°à¦¶à¦¾à¦¨à§à¦¤à¦¿à¥¤ ðŸ¤²",
      "ðŸŒ¸ Ù„ÙŽØ§ Ø§ÙÙ„ÙŽÙ‡ÙŽ Ø§ÙÙ„ÙŽÙ‘Ø§ Ø§Ù„Ù„Ù‡Ù Ù…ÙŽØ­ÙŽÙ…ÙŽÙ‘Ø¯Ù Ø±ÙŽÙ‘Ø³ÙÙˆÙ’Ù„Ù Ø§Ù„Ù„Ù‡(ï·º)\nðŸ¥° à¦²à¦¾ à¦‡à¦²à¦¾à¦¹à¦¾ à¦‡à¦²à§à¦²à¦¾à¦²à§à¦²à¦¾à¦¹à§ à¦®à§à¦¹à¦¾à¦®à§à¦®à¦¾à¦¦à§à¦° à¦°à¦¾à¦¸à§à¦²à§à¦²à§à¦²à¦¾à¦¹ (à¦¸à¦¾à¦ƒ) ðŸŒº",
      "ðŸ¥€ðŸ à¦†à¦®à¦¿ à¦œà¦¾à¦¨à§à¦¨à¦¾à¦¤ à¦¦à§‡à¦–à§‡à¦¨à¦¿, ~à¦†à¦®à¦¿ à¦†à¦®à¦¾à¦° à¦®à¦¾à¦•à§‡ à¦¦à§‡à¦–à§‡à¦›à¦¿ðŸ¥°ðŸ–¤â¤",
      "ðŸ¥€ðŸ à¦†à¦®à¦¿ à¦¨à¦¬à§€ à¦•à§‡ à¦¦à§‡à¦–à§‡à¦¨à¦¿, ~à¦¤à¦¾à¦° à¦¶à¦¿à¦•à§à¦·à¦¾ à¦ªà§‡à¦¯à¦¼à§‡à¦›à¦¿ðŸ¥°â¤ðŸ–¤",
      "ðŸ¥€ðŸ à¦†à¦®à¦¿ à¦†à¦²à§à¦²à¦¾à¦¹ à¦•à§‡ à¦¦à§‡à¦–à§‡à¦¨à¦¿, ~à¦•à¦¿à¦¨à§à¦¤à§ à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦¸à¦¾à¦œà¦¾à¦¨à§‹ à¦¦à§à¦¨à¦¿à¦¯à¦¼à¦¾ à¦¦à§‡à¦–à§‡à¦›à¦¿ðŸ¥°ðŸ–¤â¤\nà¦®à¦¨ à¦¥à§‡à¦•à§‡ à¦¬à¦²à¦¿: à¦†à¦²à¦¹à¦¾à¦®à¦¦à§à¦²à¦¿à¦²à§à¦²à¦¾à¦¹ðŸ¥°â¤ðŸ–¤",
      "ðŸ¦‹âˆ™â”€â”€à¼…à¼Žï·½à¼Žà¼…â”€â”€âˆ™ðŸ¦‹\nâšœï¸à¦†à¦œ à¦¶à¦°à§€à¦°à§‡ à¦¶à¦•à§à¦¤à¦¿ à¦†à¦›à§‡âž âà¦•à¦¿à¦¨à§à¦¤à§âž à¦‡à¦¬à¦¾à¦¦à¦¤ à¦•à¦°à¦¾à¦° à¦‡à¦šà§à¦›à¦¾ à¦¨à§‡à¦‡â€¦!!\nâšœï¸à¦•à¦¾à¦² à¦‡à¦¬à¦¾à¦¦à¦¤ à¦•à¦°à¦¾à¦° à¦‡à¦šà§à¦›à§‡ à¦¥à¦¾à¦•à¦¬à§‡âž âà¦•à¦¿à¦¨à§à¦¤à§âž à¦¶à¦°à§€à¦°à§‡ à¦¶à¦•à§à¦¤à¦¿ à¦¥à¦¾à¦•à¦¬à§‡ à¦¨à¦¾â€¦ðŸ˜­\nâšœï¸à¦†à¦²à§à¦²à¦¾à¦¹ à¦¤à¦¾à¦¯à¦¼à¦¾à¦²à¦¾ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦•à¦²à¦•à§‡ à¦¯à§Œà¦¬à¦¨ à¦•à¦¾à¦²à§‡ à¦¤à¦¾à¦° à¦‡à¦¬à¦¾à¦¦à¦¤ à¦•à¦°à¦¾à¦° à¦¤à§Œà¦«à¦¿à¦• à¦¦à¦¾à¦¨ à¦•à¦°à§à¦¨â€¦!! ðŸ¤² à¦†à¦®à¦¿à¦¨ ðŸ¤²",
      "â||ðŸ’š à¦ªà¦›à¦¨à§à¦¦à§‡à¦° à¦®à¦¾à¦¨à§à¦·à¦Ÿà¦¾ 5 à¦“à¦¯à¦¼à¦¾à¦•à§à¦¤ à¦¨à¦¾à¦®à¦¾à¦œà§€ à¦¹à¦²à§‡à¦‡ à¦šà¦²à¦¬à§‡ â€âž ðŸ¥°ðŸ˜",
      "à¦šà§‡à¦¹à¦¾à¦°à¦¾ à¦¸à§à¦¨à§à¦¦à¦° à¦¹à¦“à¦¯à¦¼à¦¾à¦° à¦šà§‡à¦¯à¦¼à§‡!! à¦šà¦°à¦¿à¦¤à§à¦° à¦¸à§à¦¨à§à¦¦à¦° à¦¹à¦“à¦¯à¦¼à¦¾ à¦¬à§‡à¦¶à¦¿ à¦ªà§à¦°à¦¯à¦¼à§‹à¦œà¦¨!! ðŸŒ¸ðŸ’–ðŸŒ¸",
      "à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¾ à¦®à§à¦¸à¦²à¦®à¦¾à¦¨ à¦¯à§‡à¦¨à§‹ à¦•à¦¾à¦²à§‡à¦®à¦¾ à¦ªà¦¡à¦¼à§‡ à¦®à§ƒà¦¤à§à¦¯à§ à¦¬à¦°à¦£ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‡ðŸ¥°\nÙ„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…Ø¯ Ø±Ø³ÙˆÙ„ Ø§Ù„Ù„Ù‘Ù‡\nðŸŒ¸â€ð€ð¥ð¡ðšð¦ðð®ð¥ð¢ð¥ð¥ðšð¡â€ðŸŒ¸",
      "âð€ð¥ð°ðšð²ð¬ ðŒðšð¤ðž ðƒð®ðšâžðŸ¤²\nà¦•à¦¾à¦°à¦£â€¦ à¦†à¦²à§à¦²à¦¾à¦¹ à¦à¦• à¦®à§à¦¹à§‚à¦°à§à¦¤à§‡ à¦¤à§‹à¦®à¦¾à¦° à¦œà§€à¦¬à¦¨ à¦¬à¦¦à¦²à§‡ à¦¦à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨ðŸ’–",
    ];

    const randomLine = islamicLines[Math.floor(Math.random() * islamicLines.length)];

    // ==================== Final Reply ====================
    const replyMsg = `â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
 à¦“à§à¦à§Ÿà¦¾à§à¦à¦²à¦¾à§à¦à¦‡à§à¦à¦•à§à§à¦à¦®à§à¦ðŸŒ·à¦†à§à¦à¦¸à§à¦à¦¸à¦¾à§à¦à¦²à¦¾à§à¦à¦®à§à¦
ð–ð€ð€ð‹ð€ðˆðŠð”ðŒðŸŒ·ð€ð’ð’ð€ð‹ð€ðŒ

ðŸ‘¤ à¦ªà§à¦°à¦¿à§à¦à§Ÿà§à¦ à¦­à¦¾à§à¦à¦‡à§à¦/à¦¬à§‹à§à¦à¦¨à§à¦: ${name}
à¦†à§à¦à¦²à§à¦²à¦¾à§à¦à¦¹à§à¦ à¦¤à§‹à§à¦à¦®à¦¾à§à¦à¦°à§à¦ à¦“à§à¦à¦ªà§à¦à¦°à§à¦ 
à¦°à§à¦à¦¹à§à¦à¦®à§à¦à¦¤à§à¦ à¦¬à§à¦à¦°à§à¦·à¦£à§à¦ à¦•à§à¦à¦°à§à§à¦à¦•à§à¦ðŸ¤²
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
${randomLine}
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
ð“†©ðŒð† áÖŸâƒžð‘à½à½²à¼à½‹à¾€ âŠ±âƒžð‰ ð”ð–ð„ð‹ð“†ªà¼¢à¿
ð…ðâž fb.com/mrjuwel2025
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`;

    return api.sendMessage(
      {
        body: replyMsg,
        attachment: fs.createReadStream(imgPath),
      },
      threadID,
      () => fs.existsSync(imgPath) && fs.unlink(imgPath, () => {}),
      messageID
    );

  } catch (error) {
    console.error("âŒ Salam reply error:", error);
  }
};

module.exports.run = () => {};
